# Tessellated Security
Tessellated Security is an end-to-end service to take your own tessel 2 and a magnetic switch and build your own security system. 

For the DYI security afficionado, all inclusive code to run a server (Node/Express), webclient, database (MongoDB/Mongoose), and a [tessel](https://tessel.io/) hooked up to a [magnetic door switch](https://www.sparkfun.com/products/13247). A detailed spec sheet of all of the parts used is below along with detailed instructions on how to put what where.  The project's server running here is hosted on Heroku while the database is on mLab. Below is an explanation about setting up your own tessel.

## Server
The server at this time is currently hosted on Heroku. I used CircleCI for continuous integration testing. [Github repo for the server API for the service.](https://github.com/EnshaednHiker/tessellated-security-server) The database for the data layer is hosted on mLab

## Webclient
[Live website for the service.](https://enshaednhiker.github.io/tessellated-security-webclient/) [Github Repo for the client website used to sign up for the service.](https://github.com/EnshaednHiker/tessellated-security-webclient) I used webpack and director as the two chief technologies to make this site.   

## Commandline Package
[Commandline package Github Repo for code to be installed onto a tessel](https://github.com/EnshaednHiker/tessellated-security-command-line-package). I wrote the command line package in node and [published it to NPM](https://www.npmjs.com/package/tessellated-security). As of now, the the only way to get the code on to the tessel is through this npm package. 

## Tutorial

### 1. Spec sheet - gathering the parts you'll need

1. [Tessel](https://www.sparkfun.com/products/13841?ref=tessel.io)
2. [Magnetic Switch](https://www.sparkfun.com/products/13247)
3. [USB micro-B cable](https://www.sparkfun.com/products/10215) (NOTE: most charging cables that come with Android smartphones are USB micro-B cables, so you  might not need to purchase one of these)
4. [USB Power Adapter](https://www.sparkfun.com/products/11456)

### 2. Set up an account on the web client and add a device to your account

1. Go to the [website](https://enshaednhiker.github.io/tessellated-security-webclient/)
2. Click on "Register" in the nav bar
3. Fill in information to add an account. The email you put in will be the email that you will receive alerts through. The email can be changed later if you wish.
4. Add a device to your account. Give it a name that will be meaningful for the alert you receive. For instance, if you gave your device the name "back door," the alert you'll receive from that device will be "Alert: the back door opened."
5. Copy the token that gets generated by the site. This token is used later in setting up code on the tessel.

Note: say you add a device your account in the website, set up a tessel with that generated token, and then install a token on a door. If you delete your device in your accout, that will render that device useless, and you'll need to add a new device your account, push code again to the tessel with the newly generated token, and then reinstall the token on your door.

Watch the video from 0:00 to 2:30 for a comprehensive walkthrough on using the website.

### 3. Assembly - putting together the tessel

Watch the video from 2:31 to 3:20 for a comprehensive walthrough on how the pieces should fit together. It's pretty simple, but you may need some wire strippers to expose more of the wire to get it seat fully into the connectors. 

1. The short wire of the magnetic switch goes in the "GND" port on Port side A.
2. The long wire of the magnetic switch goes in the "2" port on Port side A.
3. If those wires aren't in those exact spots, the tessel will not work.
4. Insert the USB micro-B cable into the appropriate slot. It is a little stiff the first time you put it in. The tessel can run off USB power when plugged into your computer. This if fine for when you are setting up code on your tessel.
5. When you want your tessel to work in the real world, you'll want to hook up your USB power adapter instead of relying on power from your computer.
Note: the wires from the magnetic switch fit very loosely into the tessel, so you'll need to find a way get them to stay.
 
### 4. Push code to tessel with the NPM package via command line commands

Watch the video from 3:21-5:26 for a comprehensive walthrough on how to push the code to the tessel

#### Install

```bash
npm install -g tessellated-security
```

#### Usage

1. Make sure you are using the LTS version of Node/npm package manager. That can be found [here](https://nodejs.org/en/).

2. Go to the command line utility on your computer. I am a fan of [cmder](http://cmder.net/) if you're on a Windows computer but the Command Prompt program will work fine too. If you're on Mac or Linux machine, you are on your own.

3. Before installing the files on your tessel, you will need to set it up. Read all through steps 0, 1, and 2 [here](https://tessel.github.io/t2-start/), and do steps 1 and 2.  This package depends on you already having installed the tessel CLI via `npm install -g t2-cli` in the command line.  This system also requires that your tessel have access to the internet, so make sure you follow the instructions in step 2 on how to set up wifi on your tessel. NOTE: I had a weird wifi setup with a poorly set up DSL modem and router, and did a ton of reading up on stack overflow and tessel developer communities only to realize that the problem was not the tessel and was in fact my weird internet setup. Simply by upgrading to the [NETGEAR Nighthawk AC1900 Wi-Fi VDSL/ADSL Modem Router](https://www.amazon.com/gp/product/B0111MRL4S/ref=oh_aui_search_detailpage?ie=UTF8&psc=1) for Centurylink DSL internet, I totally fixed my problem. FYI in case someone else has a similar problem with setting up their wifi on their tessel.

4. Go into your command line program of choice and type `npm install -g tessellated-security` and hit enter. This installs the package globally, meaning you don't have to know where package files are in your system in order to access them.

5. Go to the [Tessellated Security website](https://enshaednhiker.github.io/tessellated-security-webclient/) and create an account. Click the 'Register' tab in the navigation bar, enter your information, and click the submit button. On your account page, enter the name of your device and hit enter. Most likely you will want to name it something that connotes which door it is guarding i.e. backdoor, garage door, front door, etc. When you receive alerts from the tessel whenever the door opens, whatever you named your tessel clues you in as to which door opened. On your account page with the tessel device added to your account, copy the entire token to your clipboard.

6. With your tessel plugged in via usb to your computer, type `tessellated-security` in your command line program and hit enter. You will then be prompted to enter a token. Paste in your token you copied from your account page on the Tessellated Security website.  Hit enter.  Your tessel will then take about 2 to 3 minutes to get set up on and push over the files to make the system work. Once the process is over, you can unplug your tessel from your computer and install it on your door of choice. Now, whenever that tessel is connected to power and wifi, your security system will run, and you will receive emails noting each time that door opens/whenever the magnet separates. 

### 5. Install tessel onto a door

The magnetic switch I've listed in the spec sheet works but is flimsy and made of plastic. In a more polished product, a sturdier switch would need to be used.  Given that this is a DIY project for enjoyment and your own personal fun, I don't recommend that you use the screws to screw this switch onto an actual door. Some kind of command strips from 3M would probably be more appropriate. The magnetic switch itself comes with tape on its back, but that's obviously only a one-time use. 

### 6. Potential ideas for using this service:

1. Put it on your fridge you keep your treasured snacks safe.
2. Put it on your front door to know when your kids get home from school.
3. Put it on your garage door (if your wifi reaches that far) to know when your significant other comes home.
4. And anything else you can think of!

### 7. Video Tutorial and Demo of the the system in action

<a href="http://www.youtube.com/watch?feature=player_embedded&v=IHuYJmVRc1I
" target="_blank"><img src="http://img.youtube.com/vi/IHuYJmVRc1I/0.jpg" 
alt="IMAGE ALT TEXT HERE" width="240" height="180" border="10" /></a>

1. 0:00-2:30 shows how to use the website
2. 2:31-3:20 shows how to assemble the tessel
3. 3:21-5:26 shows how to put the code onto the tessel with the command line commands via npm
4. 5:27-6:38 shows a basic demo of the device working

## License

[MIT](http://vjpr.mit-license.org)
